    const matchingPrompt = `‚õî R√àGLE D'EX√âCUTION ‚Äî LECTURE AVANT ACTION

TANT QUE l'utilisateur n'a PAS √©crit exactement :
GO

AXIOM DOIT :
‚Ä¢ afficher uniquement le message de pr√©ambule ci-dessous,
‚Ä¢ NE PAS ex√©cuter le matching,
‚Ä¢ NE PAS afficher la suite du prompt,
‚Ä¢ NE PAS produire d'analyse,
‚Ä¢ NE PAS anticiper la suite.

D√àS QUE l'utilisateur √©crit exactement :
GO

ALORS :
‚Ä¢ AXIOM ex√©cute imm√©diatement et int√©gralement
le PROMPT MATCHING ‚Äî AXIOM_ELGAENERGY
sans transition, sans commentaire, sans texte interm√©diaire.

‚ù§Ô∏è Avant d'aller plus loin

Tu viens de passer du temps √† faire ton profil.
Ce temps, on le respecte.

AXIOM a √©t√© construit gr√¢ce aux retours de personnes comme toi.
C'est vraiment vos avis, vos ressentis, qui nous permettent de l'am√©liorer et de le rendre juste.

Avant d'acc√©der √† ton matching,
si tu es d'accord, dis-nous simplement ce que tu as pens√© de ton profil ‚ù§Ô∏è
C'est anonyme, et √ßa ne change rien √† la suite.

üëâ Donner mon ressenti (anonyme)
üëâ https://tally.so/r/44JLbB

‚Äî

Si tu pr√©f√®res continuer sans r√©pondre, aucun souci.

Promis, plus aucune question, c'est termin√© !

Pour acc√©der √† ton matching, √©cris simplement :

GO

üî∑ PROMPT MATCHING ‚Äî AXIOM_ELGAENERGY
(Phase 2 ‚Äî D√©cision & Projection)

‚õî R√àGLE ABSOLUE DE CONTEXTE

Ce prompt est une PHASE D'EX√âCUTION IND√âPENDANTE.

AXIOM_ELGAENERGY intervient APR√àS la synth√®se finale AXIOM.
Il a l'autorisation explicite de :
‚Ä¢ relire l'int√©gralit√© de la conversation depuis le d√©but,
‚Ä¢ exploiter toutes les r√©ponses du candidat,
‚Ä¢ exploiter la synth√®se finale comme un mat√©riau,
‚Ä¢ produire une d√©cision de matching ind√©pendante.

La synth√®se finale n'est PAS une conclusion.
Elle ne garantit NI alignement, NI compatibilit√©.

‚∏ª

üß† CHANGEMENT D'√âTAT ‚Äî MODE D√âCISIONNEL

√Ä partir de ce point :
AXIOM cesse toute posture exploratoire ou introspective.
AXIOM devient AXIOM_ELGAENERGY.

AXIOM_ELGAENERGY est un moteur de d√©cision professionnelle.
Son r√¥le n'est PAS de rassurer.
Son r√¥le n'est PAS de s√©duire.
Son r√¥le est de trancher proprement.

‚∏ª

üîí CHARGEMENT DES R√âF√âRENTIELS INTERNES (INVISIBLES)

AXIOM_ELGAENERGY charge strictement en interne :

1Ô∏è‚É£ AXIOM_POSTE ‚Äî Courtier en √©nergie (ElgaEnergy)
‚Ä¢ Vente assum√©e, exposition r√©elle au refus
‚Ä¢ Prospection active, construction long terme
‚Ä¢ Autonomie forte, discipline personnelle
‚Ä¢ Revenu directement li√© √† l'effort
‚Ä¢ Portefeuille client p√©renne
‚Ä¢ Cadre non salari√©, non assist√©

2Ô∏è‚É£ AXIOM_M ‚Äî Management JAMES
‚Ä¢ Cadre exigeant, responsabilisation directe
‚Ä¢ Tol√©rance √† l'erreur SI effort r√©el
‚Ä¢ Autorit√© claire, pas de protection artificielle

3Ô∏è‚É£ AXIOM_M ‚Äî Management EDHY
‚Ä¢ Construction dans la dur√©e
‚Ä¢ Transmission, structuration
‚Ä¢ Autonomie assum√©e, mont√©e en comp√©tence

Ces r√©f√©rentiels :
‚Ä¢ ne sont jamais cit√©s,
‚Ä¢ ne sont jamais expliqu√©s,
‚Ä¢ ne sont jamais visibles pour le candidat.

‚∏ª

üß† M√âCANIQUE DE MATCHING (STRICTE)

AXIOM_ELGAENERGY √©value la compatibilit√© du profil avec le poste
selon 5 crit√®res internes :

1. Capacit√© √† soutenir un effort autonome r√©el
2. Rapport factuel √† la vente et √† l'exposition
3. Tol√©rance √† l'incertitude √©conomique
4. Compatibilit√© avec une logique long terme (portefeuille)
5. Coh√©rence globale du profil
   (alignement entre :
   - le moteur profond exprim√©,
   - les contraintes r√©elles du poste,
   - et les frictions identifi√©es)

üîπ R√àGLE DE POND√âRATION ‚Äî MOTEUR VS FRICTIONS

AXIOM_ELGAENERGY DOIT distinguer :

‚Ä¢ les frictions STRUCTURELLES,
‚Ä¢ des frictions COMPENSABLES par un moteur personnel explicite.

SI le candidat exprime :
‚Ä¢ un objectif personnel clair,
‚Ä¢ concret,
‚Ä¢ non abstrait,
‚Ä¢ ancr√© dans une r√©alit√© de vie (revenu, famille, libert√©, s√©curit√©),

ALORS :
‚Ä¢ une ou deux frictions sur la vente, l'exposition ou l'incertitude
PEUVENT conduire √† üîµ ALIGNEMENT CONDITIONNEL,
√† condition que ces frictions ne soient pas rejet√©es mais reconnues.

EN REVANCHE :
SI le candidat rejette explicitement :
‚Ä¢ la vente,
‚Ä¢ l'exposition,
‚Ä¢ ou la logique de revenu li√© √† l'effort,

ALORS :
‚Ä¢ la friction est consid√©r√©e comme STRUCTURELLE ‚Üí üü† PAS ALIGN√â ACTUELLEMENT.

AXIOM_ELGAENERGY DOIT d√©terminer UNE SEULE ISSUE :


üü¢ ALIGN√â  
üîµ ALIGNEMENT CONDITIONNEL  
üü† PAS ALIGN√â ACTUELLEMENT  

Aucune issue interm√©diaire.
Aucune ambigu√Øt√©.
Aucune reformulation douce.

‚∏ª

‚õî INTERDICTION FORMELLE

AXIOM_ELGAENERGY N'A PAS LE DROIT :
‚Ä¢ de promettre un r√©sultat,
‚Ä¢ de projeter une r√©ussite,
‚Ä¢ de minimiser les exigences du poste,
‚Ä¢ d'adapter le poste au profil.

Le matching √©value une compatibilit√©.
Pas un potentiel abstrait.

‚∏ª

üßæ STRUCTURE DE SORTIE ‚Äî OBLIGATOIRE

La sortie DOIT respecter STRICTEMENT l'ordre suivant :

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
üü¢ / üîµ / üü† MATCHING AXIOM ‚Äî [ISSUE]
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

‚Ä¢ 1 phrase de verdict clair
‚Ä¢ 1 paragraphe explicatif maximum
‚Ä¢ Ton mentor, pos√©, honn√™te
‚Ä¢ Aucun discours commercial
‚Ä¢ Aucune reformulation de la synth√®se AXIOM

üîé STRUCTURE D'EXPLICATION DU VERDICT (OBLIGATOIRE)

Apr√®s l'annonce du verdict,
AXIOM_ELGAENERGY DOIT produire une lecture structur√©e
de la compatibilit√© entre le profil et le poste.

Cette lecture DOIT :
‚Ä¢ √™tre visuellement lisible,
‚Ä¢ √™tre factuelle,
‚Ä¢ √©viter toute justification globale ou floue.

La structure est STRICTEMENT la suivante :

üîé Lecture de compatibilit√©

- Rapport au c≈ìur du m√©tier  
‚Üí expliquer clairement la compatibilit√© OU la friction
avec la r√©alit√© du poste
(vente, exposition, effort, incertitude).

- Rapport √† la dur√©e  
‚Üí expliquer la capacit√© OU la limite
√† soutenir un effort r√©p√©t√© dans le temps.

- Coh√©rence globale  
‚Üí conclure sur l'alignement ou la dissonance
entre le fonctionnement r√©el du profil
et le cadre r√©el du poste.

Chaque point :
‚Ä¢ UNE phrase maximum,
‚Ä¢ aucun jugement,
‚Ä¢ aucun conseil,
aucune projection.

üß≠ CADRAGE HUMAIN ‚Äî OBLIGATOIRE SELON L'ISSUE

AXIOM_ELGAENERGY DOIT ajouter UNE phrase de cadrage humain,
diff√©rente selon l'ISSUE,
sans jamais √©dulcorer la d√©cision.

SI ISSUE = üü† PAS ALIGN√â ACTUELLEMENT :
Ajouter UNE phrase indiquant clairement que
ce verdict ne remet PAS en cause la valeur du profil,
mais signale uniquement une incompatibilit√©
avec ce poste pr√©cis √† ce stade.
Rappeler implicitement que c'est pr√©cis√©ment
le r√¥le d'AXIOM d'√©viter ces mauvais alignements.

SI ISSUE = üîµ ALIGNEMENT CONDITIONNEL :
Ajouter UNE phrase indiquant clairement que
le matching n'est ni un oui automatique,
ni un non d√©finitif,
et que certaines conditions devront √™tre r√©unies
pour que le poste convienne r√©ellement.

SI ISSUE = üü¢ ALIGN√â :
Ajouter UNE phrase indiquant clairement que
le poste ne demande pas de changer de posture,
mais permet au fonctionnement naturel du profil
de s'exprimer pleinement.

Ces phrases ne doivent :
‚Ä¢ ni rassurer artificiellement,
‚Ä¢ ni promettre un r√©sultat,
‚Ä¢ ni minimiser les exigences du poste.
‚∏ª
‚õî R√àGLE CONDITIONNELLE DE PROJECTION

Les sections suivantes :
‚Ä¢ üíº PROJECTION CONCR√àTE ‚Äî COMMENT √áA SE TRADUIT
‚Ä¢ üß≠ LE CADRE ‚Äî POUR T'ACCOMPAGNER DANS LA DUR√âE

NE DOIVENT √äTRE AFFICH√âES QUE SI :
‚Ä¢ ISSUE = üü¢ ALIGN√â
‚Ä¢ ou ISSUE = üîµ ALIGNEMENT CONDITIONNEL

SI ISSUE = üü† PAS ALIGN√â ACTUELLEMENT :
Ces sections sont STRICTEMENT INTERDITES.
Aucune projection.
Aucun cadre.
Aucune anticipation.

üíº PROJECTION CONCR√àTE ‚Äî COMMENT √áA SE TRADUIT

AXIOM_ELGAENERGY DOIT :

1. Afficher OBLIGATOIREMENT l'exemple chiffr√© suivant,
STRICTEMENT √† l'identique, sans aucune modification :

"Une entreprise qui consomme 100 MWh par an sur un contrat de 4 ans, c'est 400 MWh sur la dur√©e.
Avec une commission moyenne de 3 ‚Ç¨ par MWh, cela repr√©sente 1 200 ‚Ç¨ pour un seul client."

2. Produire ensuite une lecture personnalis√©e (2 √† 3 phrases maximum) :
‚Ä¢ directement reli√©e au fonctionnement r√©el du candidat,
‚Ä¢ bas√©e uniquement sur ce qui a √©t√© observ√© dans son profil,
‚Ä¢ sans phrase g√©n√©rique,
‚Ä¢ sans valorisation automatique.

INTERDICTION FORMELLE :
‚Ä¢ phrases universelles,
‚Ä¢ phrases r√©utilisables d'un profil √† l'autre,
‚Ä¢ formulations du type "c'est l√† que ton profil prend tout son sens".
‚∏ª

üß≠ LE CADRE ‚Äî POUR T'ACCOMPAGNER DANS LA DUR√âE

AXIOM_ELGAENERGY DOIT :

‚Ä¢ d√©crire le cadre d'accompagnement tel qu'il serait v√©cu par CE candidat pr√©cis,
‚Ä¢ mettre l'accent sur les √©l√©ments r√©ellement n√©cessaires √† son fonctionnement
(structure, exigence, autonomie, s√©curisation ‚Äî selon le profil),
‚Ä¢ rester factuel, incarn√©, concret.

La formulation doit :
‚Ä¢ varier d'un candidat √† l'autre,
‚Ä¢ ne jamais reprendre une phrase existante,
‚Ä¢ √©viter toute posture marketing ou slogan.

INTERDICTION :
‚Ä¢ phrases g√©n√©riques,
‚Ä¢ formules toutes faites,
‚Ä¢ r√©p√©titions mot pour mot d'un profil √† l'autre.
‚∏ª

üöÄ POUR ALLER PLUS LOIN (BLOC FIG√â ‚Äî OBLIGATOIRE)

‚ö†Ô∏è CE BLOC DOIT √äTRE REPRODUIT √Ä L'IDENTIQUE
‚ö†Ô∏è AUCUNE MODIFICATION AUTORIS√âE

üöÄ POUR ALLER PLUS LOIN

üéØ OUVRIR LA DISCUSSION

Si, en lisant ce matching, quelque chose a r√©sonn√© ‚Äî
par curiosit√©, par projection, ou par vraie envie d'aller plus loin ‚Äî

alors tu peux ouvrir la discussion.

Pas pour "postuler".
Pas pour promettre quoi que ce soit.
Juste pour voir si ce cadre peut r√©ellement devenir concret pour toi.

üì© Envoie ton rapport √† :
contact@elgaenergy.fr

On prendra le temps d'un √©change simple, clair et s√©rieux.

ET Si tu n'as pas laiss√© ton avis n'oublie pas que ca nous aide √©norm√©ment ‚ù§Ô∏è  
c'est anonyme  

üß† Contribuer √† AXIOM (anonyme)  
Ton ressenti est ce qui permet √† AXIOM de rester juste et utile.  
Un retour rapide, sans engagement :  
üëâ https://tally.so/r/44JLbB  

‚∏ª

üîí FIN D'EX√âCUTION ‚Äî AXIOM_ELGAENERGY

Aucune relance.
Aucune question.
Aucune analyse suppl√©mentaire.

Le matching est termin√©.`;

    // Menu mobile
    const menuBtn = document.getElementById('menuBtn');
    if (menuBtn) {
      menuBtn.addEventListener('click', () => {
        const mobileMenu = document.getElementById('mobileMenu');
        if (mobileMenu) mobileMenu.classList.toggle('hidden');
      });
    }

    // Gestion de la vid√©o au survol de la carte √©tape 2 (desktop et mobile)
    const backgroundVideoDesktop = document.getElementById('backgroundVideoDesktop');
    const backgroundVideoMobile = document.getElementById('backgroundVideoMobile');
    const card2 = document.getElementById('card2');
    
    // Fonction pour obtenir la vid√©o active (desktop ou mobile)
    function getActiveVideo() {
      // V√©rifie si on est sur mobile (largeur < 768px)
      const isMobile = window.innerWidth < 768;
      return isMobile ? backgroundVideoMobile : backgroundVideoDesktop;
    }
    
    if (card2) {
      // Lance la vid√©o au survol de la carte (desktop) ou au touch (mobile)
      card2.addEventListener('mouseenter', function() {
        const activeVideo = getActiveVideo();
        if (activeVideo) {
          activeVideo.play().catch(function(error) {
          console.log('Erreur de lecture vid√©o:', error);
        });
          // Tracking Google Analytics - Vid√©o √©tape 2 d√©marr√©e
          gtag('event', 'video_play', {
            'event_category': 'Video',
            'event_label': 'Vid√©o √©tape 2',
            'value': 2
          });
        }
      });
      
      // Pour mobile : lance la vid√©o au touch
      card2.addEventListener('touchstart', function() {
        const activeVideo = getActiveVideo();
        if (activeVideo) {
          activeVideo.play().catch(function(error) {
            console.log('Erreur de lecture vid√©o:', error);
          });
          // Tracking Google Analytics - Vid√©o √©tape 2 d√©marr√©e (mobile)
          gtag('event', 'video_play', {
            'event_category': 'Video',
            'event_label': 'Vid√©o √©tape 2 (mobile)',
            'value': 2
          });
        }
      });
      
      // Arr√™te la vid√©o quand on quitte le survol (desktop)
      card2.addEventListener('mouseleave', function() {
        const activeVideo = getActiveVideo();
        const isMobile = window.innerWidth < 768;
        const progressFill = isMobile ? document.getElementById('progressFillMobile') : document.getElementById('progressFillDesktop');
        if (activeVideo) {
          activeVideo.pause();
          activeVideo.currentTime = 0; // Remet la vid√©o au d√©but
          if (progressFill) {
            progressFill.style.width = '0%'; // R√©initialise la barre de progression
          }
        }
      });
      
      // Gestion des erreurs pour les deux vid√©os
      if (backgroundVideoDesktop) {
        backgroundVideoDesktop.addEventListener('error', function() {
          console.log('Erreur de chargement de la vid√©o desktop. V√©rifiez que le fichier existe dans assets/videos/');
        this.style.display = 'none';
      });
      }
      
      if (backgroundVideoMobile) {
        backgroundVideoMobile.addEventListener('error', function() {
          console.log('Erreur de chargement de la vid√©o mobile. V√©rifiez que le fichier existe dans assets/videos/');
          this.style.display = 'none';
        });
      }
      
      // G√®re le changement de vid√©o lors du redimensionnement de la fen√™tre
      let resizeTimeout;
      window.addEventListener('resize', function() {
        clearTimeout(resizeTimeout);
        resizeTimeout = setTimeout(function() {
          // Met en pause la vid√©o inactive et remet au d√©but
          const isMobile = window.innerWidth < 768;
          if (isMobile && backgroundVideoDesktop) {
            backgroundVideoDesktop.pause();
            backgroundVideoDesktop.currentTime = 0;
          } else if (!isMobile && backgroundVideoMobile) {
            backgroundVideoMobile.pause();
            backgroundVideoMobile.currentTime = 0;
          }
        }, 250);
      });
      
      // Mise √† jour de la barre de progression pour l'√©tape 2
      function updateProgressBar2() {
        const isMobile = window.innerWidth < 768;
        const activeVideo = isMobile ? backgroundVideoMobile : backgroundVideoDesktop;
        const progressFill = isMobile ? document.getElementById('progressFillMobile') : document.getElementById('progressFillDesktop');
        
        if (activeVideo && progressFill) {
          const progress = (activeVideo.currentTime / activeVideo.duration) * 100;
          progressFill.style.width = progress + '%';
        }
      }
      
      if (backgroundVideoDesktop) {
        backgroundVideoDesktop.addEventListener('timeupdate', updateProgressBar2);
      }
      if (backgroundVideoMobile) {
        backgroundVideoMobile.addEventListener('timeupdate', updateProgressBar2);
      }
    }

    // Gestion de la vid√©o au survol de la carte √©tape 3 (desktop et mobile)
    const backgroundVideoDesktop3 = document.getElementById('backgroundVideoDesktop3');
    const backgroundVideoMobile3 = document.getElementById('backgroundVideoMobile3');
    const card3 = document.getElementById('card3');
    
    // Fonction pour obtenir la vid√©o active de l'√©tape 3 (desktop ou mobile)
    function getActiveVideo3() {
      // V√©rifie si on est sur mobile (largeur < 768px)
      const isMobile = window.innerWidth < 768;
      return isMobile ? backgroundVideoMobile3 : backgroundVideoDesktop3;
    }
    
    if (card3) {
      // Lance la vid√©o au survol de la carte (desktop) ou au touch (mobile)
      card3.addEventListener('mouseenter', function() {
        const activeVideo = getActiveVideo3();
        if (activeVideo) {
          activeVideo.play().catch(function(error) {
            console.log('Erreur de lecture vid√©o √©tape 3:', error);
          });
          // Tracking Google Analytics - Vid√©o √©tape 3 d√©marr√©e
          gtag('event', 'video_play', {
            'event_category': 'Video',
            'event_label': 'Vid√©o √©tape 3',
            'value': 3
          });
        }
      });
      
      // Pour mobile : lance la vid√©o au touch
      card3.addEventListener('touchstart', function() {
        const activeVideo = getActiveVideo3();
        if (activeVideo) {
          activeVideo.play().catch(function(error) {
            console.log('Erreur de lecture vid√©o √©tape 3:', error);
          });
          // Tracking Google Analytics - Vid√©o √©tape 3 d√©marr√©e (mobile)
          gtag('event', 'video_play', {
            'event_category': 'Video',
            'event_label': 'Vid√©o √©tape 3 (mobile)',
            'value': 3
          });
        }
      });
      
      // Arr√™te la vid√©o quand on quitte le survol (desktop)
      card3.addEventListener('mouseleave', function() {
        const activeVideo = getActiveVideo3();
        const isMobile = window.innerWidth < 768;
        const progressFill = isMobile ? document.getElementById('progressFillMobile3') : document.getElementById('progressFillDesktop3');
        if (activeVideo) {
          activeVideo.pause();
          activeVideo.currentTime = 0; // Remet la vid√©o au d√©but
          if (progressFill) {
            progressFill.style.width = '0%'; // R√©initialise la barre de progression
          }
        }
      });
      
      // Gestion des erreurs pour les deux vid√©os
      if (backgroundVideoDesktop3) {
        backgroundVideoDesktop3.addEventListener('error', function() {
          console.log('Erreur de chargement de la vid√©o desktop √©tape 3. V√©rifiez que le fichier existe dans assets/videos/');
          this.style.display = 'none';
        });
      }
      
      if (backgroundVideoMobile3) {
        backgroundVideoMobile3.addEventListener('error', function() {
          console.log('Erreur de chargement de la vid√©o mobile √©tape 3. V√©rifiez que le fichier existe dans assets/videos/');
          this.style.display = 'none';
        });
      }
      
      // G√®re le changement de vid√©o lors du redimensionnement de la fen√™tre
      let resizeTimeout3;
      window.addEventListener('resize', function() {
        clearTimeout(resizeTimeout3);
        resizeTimeout3 = setTimeout(function() {
          // Met en pause la vid√©o inactive et remet au d√©but
          const isMobile = window.innerWidth < 768;
          if (isMobile && backgroundVideoDesktop3) {
            backgroundVideoDesktop3.pause();
            backgroundVideoDesktop3.currentTime = 0;
          } else if (!isMobile && backgroundVideoMobile3) {
            backgroundVideoMobile3.pause();
            backgroundVideoMobile3.currentTime = 0;
          }
        }, 250);
      });
      
      // Mise √† jour de la barre de progression pour l'√©tape 3
      function updateProgressBar3() {
        const isMobile = window.innerWidth < 768;
        const activeVideo = isMobile ? backgroundVideoMobile3 : backgroundVideoDesktop3;
        const progressFill = isMobile ? document.getElementById('progressFillMobile3') : document.getElementById('progressFillDesktop3');
        
        if (activeVideo && progressFill) {
          const progress = (activeVideo.currentTime / activeVideo.duration) * 100;
          progressFill.style.width = progress + '%';
        }
      }
      
      if (backgroundVideoDesktop3) {
        backgroundVideoDesktop3.addEventListener('timeupdate', updateProgressBar3);
      }
      if (backgroundVideoMobile3) {
        backgroundVideoMobile3.addEventListener('timeupdate', updateProgressBar3);
      }
    }

    // Fonction pour passer √† une carte sp√©cifique (accessible globalement)
    window.showCard = function(cardNumber) {
      // Cache toutes les cartes
      document.querySelectorAll('.step-card').forEach(card => {
        card.classList.add('hidden');
      });
      
      // Affiche la carte demand√©e avec une animation rapide
      const targetCard = document.getElementById('card' + cardNumber);
      if (targetCard) {
        targetCard.classList.remove('hidden');
        targetCard.style.opacity = '0';
        targetCard.style.transition = 'opacity 0.2s ease-in-out';
        
        // Animation rapide
        requestAnimationFrame(() => {
          targetCard.style.opacity = '1';
        });
        
        // Scroll vers la carte
        targetCard.scrollIntoView({ behavior: 'smooth', block: 'center' });
        
        // Marquer si l'utilisateur arrive sur la carte 4
        if (cardNumber === 4) {
          reachedCard4 = true;
        }
      }
    }

    // √âtape 1 : G√©n√©rer la cl√© AXIOM
    document.getElementById('generateAxiomBtn').addEventListener('click', async function() {
      try {
        await navigator.clipboard.writeText(axiomPrompt);
        
        console.log('‚úì Prompt 1 (test AXIOM) copi√© dans le presse-papiers');
        
        // Tracking Google Analytics - √âtape 1 compl√©t√©e
        gtag('event', 'funnel_step_1_completed', {
          'event_category': 'Funnel',
          'event_label': 'G√©n√©ration cl√© AXIOM',
          'value': 1
        });
        
        // Feedback visuel temporaire
        const originalText = this.querySelector('span').textContent;
        this.querySelector('span').textContent = '‚úì Copi√© dans le presse-papiers !';
        this.style.transform = 'scale(0.98)';
        
        // Changement de carte imm√©diat
        setTimeout(() => {
          showCard(2);
        }, 200);
      } catch (err) {
        console.log('‚ö†Ô∏è Impossible de copier le prompt 1:', err);
        // Fallback pour les navigateurs plus anciens
        const textArea = document.createElement('textarea');
        textArea.value = axiomPrompt;
        textArea.style.position = 'fixed';
        textArea.style.opacity = '0';
        document.body.appendChild(textArea);
        textArea.select();
        try {
          document.execCommand('copy');
          
          // Tracking Google Analytics - √âtape 1 compl√©t√©e (fallback)
          gtag('event', 'funnel_step_1_completed', {
            'event_category': 'Funnel',
            'event_label': 'G√©n√©ration cl√© AXIOM (fallback)',
            'value': 1
          });
          
          const originalText = this.querySelector('span').textContent;
          this.querySelector('span').textContent = '‚úì Copi√© !';
          setTimeout(() => {
            showCard(2);
          }, 200);
        } catch (fallbackErr) {
          alert('Impossible de copier automatiquement. Le texte est trop long.');
        }
        document.body.removeChild(textArea);
      }
    });

    // √âtape 2 : Ouvrir ChatGPT
    document.getElementById('openChatGPTBtn').addEventListener('click', async function() {
      // Re-copier le premier prompt (axiomPrompt) au cas o√π il aurait √©t√© perdu
      try {
        await navigator.clipboard.writeText(axiomPrompt);
        console.log('‚úì Prompt 1 (test AXIOM) copi√© dans le presse-papiers');
      } catch (err) {
        console.log('‚ö†Ô∏è Impossible de copier le prompt 1:', err);
      }
      
      // Tracking Google Analytics - √âtape 2 compl√©t√©e
      gtag('event', 'funnel_step_2_completed', {
        'event_category': 'Funnel',
        'event_label': 'Ouverture ChatGPT',
        'value': 2
      });
      
      // Ouvrir ChatGPT dans un nouvel onglet
      window.open('https://chat.openai.com', '_blank');
      
      // Passer √† la carte 3 imm√©diatement
        showCard(3);
    });

    // √âtape 3 : G√©n√©rer le matching
    document.getElementById('generateMatchingBtn').addEventListener('click', async function() {
      try {
        await navigator.clipboard.writeText(matchingPrompt);
        
        console.log('‚úì Prompt 2 (matching) copi√© dans le presse-papiers');
        
        // Tracking Google Analytics - √âtape 3 compl√©t√©e
        gtag('event', 'funnel_step_3_completed', {
          'event_category': 'Funnel',
          'event_label': 'G√©n√©ration lecture de compatibilit√©',
          'value': 3
        });
        
        // Feedback visuel temporaire
        const originalText = this.querySelector('span').textContent;
        this.querySelector('span').textContent = '‚úì Copi√© dans le presse-papiers !';
        this.style.transform = 'scale(0.98)';
        
        // Changement de carte imm√©diat
        setTimeout(() => {
          showCard(4);
        }, 200);
      } catch (err) {
        console.log('‚ö†Ô∏è Impossible de copier le prompt 2:', err);
        // Fallback pour les navigateurs plus anciens
        const textArea = document.createElement('textarea');
        textArea.value = matchingPrompt;
        textArea.style.position = 'fixed';
        textArea.style.opacity = '0';
        document.body.appendChild(textArea);
        textArea.select();
        try {
          document.execCommand('copy');
          
          // Tracking Google Analytics - √âtape 3 compl√©t√©e (fallback)
          gtag('event', 'funnel_step_3_completed', {
            'event_category': 'Funnel',
            'event_label': 'G√©n√©ration lecture de compatibilit√© (fallback)',
            'value': 3
          });
          
          const originalText = this.querySelector('span').textContent;
          this.querySelector('span').textContent = '‚úì Copi√© !';
          setTimeout(() => {
            showCard(4);
          }, 200);
        } catch (fallbackErr) {
          alert('Impossible de copier automatiquement. Le texte est trop long.');
        }
        document.body.removeChild(textArea);
      }
    });

    // Note : Pas besoin d'event listener pour l'√©tape 4
    // Le prompt est d√©j√† copi√© √† l'√©tape 3, l'utilisateur n'a plus qu'√† retourner sur ChatGPT manuellement

    // Tracking des boutons "Pr√©c√©dent"
    const prevBtnCard2 = document.getElementById('prevBtnCard2');
    if (prevBtnCard2) {
      prevBtnCard2.addEventListener('click', function() {
        gtag('event', 'funnel_previous_button', {
          'event_category': 'Funnel',
          'event_label': 'Bouton pr√©c√©dent - Carte 2 vers Carte 1',
          'value': 1
        });
      });
    }

    const prevBtnCard3 = document.getElementById('prevBtnCard3');
    if (prevBtnCard3) {
      prevBtnCard3.addEventListener('click', function() {
        gtag('event', 'funnel_previous_button', {
          'event_category': 'Funnel',
          'event_label': 'Bouton pr√©c√©dent - Carte 3 vers Carte 2',
          'value': 2
        });
      });
    }

    const prevBtnCard4 = document.getElementById('prevBtnCard4');
    if (prevBtnCard4) {
      prevBtnCard4.addEventListener('click', function() {
        gtag('event', 'funnel_previous_button', {
          'event_category': 'Funnel',
          'event_label': 'Bouton pr√©c√©dent - Carte 4 vers Carte 3',
          'value': 3
        });
      });
    }

    // Tracking du scroll - Mesure de l'engagement
    let scroll80Sent = false; // Flag pour √©viter d'envoyer l'√©v√©nement 80% plusieurs fois
    let scrollLessThan50Sent = false; // Flag pour √©viter d'envoyer l'√©v√©nement < 50% plusieurs fois
    let maxScrollReached = 0; // Pour suivre le scroll maximum atteint
    let reachedCard4 = false; // Flag pour savoir si l'utilisateur est arriv√© sur la carte 4
    let leftAfterCard4Sent = false; // Flag pour √©viter d'envoyer l'√©v√©nement plusieurs fois
    
    // Fonction pour calculer le pourcentage de scroll
    function getScrollPercentage() {
      const windowHeight = window.innerHeight;
      const documentHeight = document.documentElement.scrollHeight;
      const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
      const scrollPercentage = (scrollTop / (documentHeight - windowHeight)) * 100;
      return Math.min(scrollPercentage, 100); // Limiter √† 100%
    }
    
    // Event listener pour le scroll - Suivre le scroll maximum atteint
    let scrollTimeout;
    window.addEventListener('scroll', function() {
      clearTimeout(scrollTimeout);
      scrollTimeout = setTimeout(function() {
        const scrollPercentage = getScrollPercentage();
        maxScrollReached = Math.max(maxScrollReached, scrollPercentage);
      }, 150); // Debounce pour √©viter trop d'appels
    });
    
    // D√©tecter quand l'utilisateur quitte la page
    window.addEventListener('beforeunload', function() {
      // √âv√©nement : Quitte apr√®s √™tre arriv√© sur l'√©tape 4 (va sur ChatGPT)
      if (reachedCard4 && !leftAfterCard4Sent) {
        leftAfterCard4Sent = true;
        gtag('event', 'funnel_completed_and_left', {
          'event_category': 'Funnel',
          'event_label': 'Compl√®te le funnel et quitte pour ChatGPT',
          'value': 4
        });
      }
      
      // √âv√©nement : Quitte avant 50% de scroll
      if (maxScrollReached < 50 && !scrollLessThan50Sent && !scroll80Sent) {
        // Utiliser sendBeacon pour envoyer l'√©v√©nement m√™me si la page se ferme
        if (navigator.sendBeacon) {
          // Note: sendBeacon n√©cessite une URL, on ne peut pas l'utiliser directement avec gtag
          // On va plut√¥t utiliser visibilitychange qui est plus fiable
        }
      }
    });
    
    // Alternative plus fiable : utiliser visibilitychange
    document.addEventListener('visibilitychange', function() {
      if (document.hidden) {
        // L'utilisateur quitte ou change d'onglet
        
        // √âv√©nement : Quitte apr√®s √™tre arriv√© sur l'√©tape 4 (va sur ChatGPT)
        if (reachedCard4 && !leftAfterCard4Sent) {
          leftAfterCard4Sent = true;
          gtag('event', 'funnel_completed_and_left', {
            'event_category': 'Funnel',
            'event_label': 'Compl√®te le funnel et quitte pour ChatGPT',
            'value': 4
          });
        }
        
        // √âv√©nement : Quitte avant 50% de scroll
        if (maxScrollReached < 50 && !scrollLessThan50Sent && !scroll80Sent) {
          scrollLessThan50Sent = true;
          gtag('event', 'scroll_less_than_50', {
            'event_category': 'Engagement',
            'event_label': 'Quitte la page avant 50% de scroll - Pas de lecture',
            'value': maxScrollReached
          });
        }
      }
    });
    
    // IntersectionObserver pour d√©tecter quand le bloc AXIOM est visible (80% de scroll)
    const blocAxiom = document.getElementById('bloc-axiom');
    if (blocAxiom) {
      const observerAxiom = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting && !scroll80Sent) {
            scroll80Sent = true;
            gtag('event', 'scroll_80_percent', {
              'event_category': 'Engagement',
              'event_label': 'Scroll jusqu\'√† 80% - Bloc AXIOM visible',
              'value': 80
            });
          }
        });
      }, {
        threshold: 0.5 // D√©clenche quand au moins 50% du bloc est visible
      });
      
      observerAxiom.observe(blocAxiom);
    }

    // Effet de typing pour la citation - d√©clench√© au scroll
    const quoteText = "- L'alignement parfait ne doit plus √™tre du hasard...\nMais une √©vidence -";
    const typedTextLine1 = document.querySelector('.typed-text-line1');
    const typedTextLine2 = document.querySelector('.typed-text-line2');
    const typingQuoteSection = document.getElementById('typing-quote');
    
    let hasAnimated = false; // Flag pour s'assurer que l'animation ne se d√©clenche qu'une fois
    
    if (typedTextLine1 && typedTextLine2 && typingQuoteSection) {
      const typingSpeed = 80; // millisecondes par caract√®re
      
      function startTyping() {
        if (hasAnimated) return; // Ne pas relancer si d√©j√† anim√©
        hasAnimated = true;
        
        let charIndex = 0;
        let line1Text = '';
        let line2Text = '';
        let isLine2 = false;
        
        function typeText() {
          if (charIndex < quoteText.length) {
            const char = quoteText.charAt(charIndex);
            // G√©rer les sauts de ligne
            if (char === '\n') {
              isLine2 = true;
            } else {
              // √âchapper les caract√®res HTML sp√©ciaux
              const escapedChar = char.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');
              if (isLine2) {
                line2Text += escapedChar;
                typedTextLine2.textContent = line2Text;
              } else {
                line1Text += escapedChar;
                typedTextLine1.textContent = line1Text;
              }
            }
            charIndex++;
            setTimeout(typeText, typingSpeed);
          }
        }
        
        // Attendre 300ms avant de commencer l'animation
        setTimeout(() => {
          typeText();
        }, 300);
      }
      
      // Intersection Observer pour d√©tecter quand la section entre dans le viewport
      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting && !hasAnimated) {
            startTyping();
            // D√©sobserver apr√®s le premier d√©clenchement
            observer.unobserve(entry.target);
          }
        });
      }, {
        threshold: 0.3 // D√©clenche quand 30% de la section est visible
      });
      
      observer.observe(typingQuoteSection);
    }
  </script>

</body>
